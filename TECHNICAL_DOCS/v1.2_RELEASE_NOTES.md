# v1.2 Release Notes - Technical Documentation

**Release Date:** January 22, 2026  
**Version:** v1.2  
**Status:** Stable (Superseded by v1.2.1, v1.2.2)

---

## Overview

v1.2 was a maintenance and stability release focusing on bug fixes, code quality improvements, and architectural enhancements. This release introduced no breaking changes and remains backward-compatible with v1.1.

**Key Focus:** Bug fixing, validation improvements, and robustness

---

## What's New in v1.2

### Bug Fixes (19 Total)

This release includes comprehensive bug fixes across all major components. See [BUG_FIXES_v1.2.md](BUG_FIXES_v1.2.md) for detailed technical analysis of each bug.

#### Critical Fixes (5)

1. **Registry path handling** - Fixed corruption of InstallPath registry entries when installation path contains spaces
2. **Scheduled task creation failure** - Resolved issue where task failed to register on certain Windows 10 builds
3. **Config file parsing** - Fixed line-ending handling for CRLF vs LF inconsistencies
4. **Sound playback blocking** - Corrected async issue causing welcome message to hang during audio playback
5. **Cursor file validation** - Fixed crash when .cur files are missing file extensions

#### High Priority Fixes (5)

1. **Registry verification** - Added fallback logic when registry write verification fails
2. **PowerShell execution policy** - Improved error handling when execution policy cannot be set
3. **Theme color application** - Added verification step for accent color application
4. **Startup sound enablement** - Corrected registry path and validation
5. **Task Scheduler trigger validation** - Enhanced detection of LogOn triggers

#### Medium Priority Fixes (9)

1. **Configuration validation** - Improved error messages for invalid ANNIVERSARY_DATE formats
2. **Message count validation** - Better handling of empty MESSAGES sections
3. **Directory creation** - Added verification for all installation directories
4. **File copy operations** - Enhanced error handling during file deployment
5. **Registry cleanup** - Improved uninstall process to remove all created keys
6. **Accent color verification** - Added hex color value comparison
7. **Cursor path handling** - Fixed file path issues with special characters
8. **Task description clarity** - Standardized task metadata
9. **Log output formatting** - Improved diagnostic messages for troubleshooting

### Validation Rule Improvements

Validation rules expanded from 3 to 11 comprehensive checks:

**Core Validation Rules:**

- UTF-8 BOM encoding detection and enforcement
- Required section presence ([USER], [DATES], [MESSAGES])
- ANNIVERSARY_DATE format validation (YYYY-MM-DD)
- Future date prevention (cannot set anniversary in future)
- Message count validation (minimum 1, no maximum)
- Individual message length validation (maximum 200 characters)
- HER_NAME field validation (1-100 characters)
- WELCOME_TIMEOUT range validation (5-300 seconds)
- Section structure validation (proper INI format)
- Reserved [FUTURE] section handling
- Invalid section rejection

**Validation Severity Levels:**

- **Critical:** Would prevent installation (encoding, required sections)
- **High:** Would cause runtime failures (date format, message content)
- **Medium:** Would degrade user experience (timeout values, name length)

### Code Quality Enhancements

#### PowerShell Scripts

- Improved error handling with try-catch blocks throughout
- Consistent progress indicators ([1/8], [2/8], etc.)
- Better variable naming and code organization
- Comprehensive comments explaining complex logic
- Execution policy configuration with fallback
- Registry write verification with error reporting

#### Configuration Parsing

- Section-aware parsing with proper state management
- Line-ending normalization (handles CRLF and LF)
- UTF-8 BOM header detection
- Graceful degradation when config is incomplete
- Default values for missing optional sections

#### File Handling

- WAV file RIFF header validation (bytes 0-3, 8-11)
- Cursor file type detection (.cur vs .ani)
- Robust file copy with force overwrite
- Directory creation with recursive support
- Safe cleanup with verification

#### Registry Operations

- Write operation verification
- Registry path existence checking
- DWord vs String type handling
- Error recovery with fallback defaults
- Installation path portability support

### Performance Improvements

- Reduced installation time through optimized registry operations
- Faster config file parsing with improved algorithms
- More efficient file copy operations (batch processing)
- Reduced startup memory footprint for scheduled task

### Architecture Updates

See [ARCHITECTURE.md](../TECHNICAL_DOCS/ARCHITECTURE.md) for complete system design documentation.

**Key Architectural Changes:**

- Enhanced 5-layer component architecture (Installation, Runtime, Storage, Verification, Cleanup)
- Improved scheduled task lifecycle management (6-stage process)
- Better error handling architecture with graceful degradation
- Enhanced resource management (critical timer cleanup)
- Improved security architecture with execution context clarity

---

## Compatibility

### Windows Versions

- **Windows 10:** Build 1809 and later (fully tested and supported)
- **Windows 11:** All builds (fully tested and supported)

### PowerShell

- **Minimum:** PowerShell 5.0
- **Recommended:** PowerShell 5.1 (Windows 10) or built-in (Windows 11)

### System Requirements

- Administrator privileges required for installation
- 50 MB free disk space
- .NET Framework 3.5+ (for Windows.Forms UI)

---

## Known Limitations (from v1.1)

1. **Multi-user systems** - Installation is per-user (not system-wide)
2. **Portable installation** - Must run from same folder as scripts
3. **Cursor setup** - May require manual configuration on some systems
4. **Sound playback** - Requires audio device and proper driver support
5. **Registry access** - Limited to HKCU (user hive), not HKLM (system hive)

These are intentional design choices for portability and non-invasiveness.

---

## Migration from v1.1

No migration required. v1.2 is fully backward compatible with v1.1 installations:

**Automatic upgrade path:**

1. Run v1.2 INSTALL.ps1 (will replace v1.1 files)
2. No configuration changes needed
3. Existing config.txt works unchanged
4. Scheduled task automatically updated

**Manual cleanup (optional):**

```powershell
# Remove old v1.1 files (if desired)
Remove-Item "C:\RomanticCustomization\WelcomeMessage_old.ps1" -Force
```

---

## Detailed Bug Analysis

For comprehensive technical details on each bug, including root cause analysis, code examples, and testing procedures, see [BUG_FIXES_v1.2.md](BUG_FIXES_v1.2.md).

### Bug Distribution

| Category            | Count | Examples                             |
| ------------------- | ----- | ------------------------------------ |
| Registry Operations | 4     | Path corruption, write verification  |
| Config Parsing      | 3     | Line ending, encoding, validation    |
| File Handling       | 4     | WAV validation, cursor files, paths  |
| UI/Task Scheduling  | 5     | Task creation, colors, startup sound |
| Error Handling      | 3     | Policy errors, directory creation    |

---

## Testing Summary

### Installation Testing

- ? Clean installation (multiple paths)
- ? Upgrade from v1.1
- ? Config validation
- ? File integrity checks
- ? Registry operations
- ? Task Scheduler integration

### Functionality Testing

- ? Welcome message display
- ? Sound playback
- ? Theme color application
- ? Cursor installation
- ? Timeout configuration
- ? Unicode name support

### Error Handling Testing

- ? Missing files
- ? Invalid config files
- ? Registry access failures
- ? Permission issues
- ? Corrupted WAV files
- ? Disk space limitations

### Compatibility Testing

- ? Windows 10 (Build 1809, 1909, 2004, 21H2)
- ? Windows 11 (Build 22000, 22621)
- ? PowerShell 5.0 vs 5.1
- ? Admin vs standard user context
- ? UAC enabled/disabled

---

## What's Next

### Upcoming in v1.2.1

Documentation restructuring and organization improvements:

- Master documentation index
- Separated user-friendly vs technical guides
- Comprehensive troubleshooting guides
- Version history documentation
- Windows compatibility matrix

### Planned for v1.3+

- Voice message support
- Graphical configuration editor
- Calendar integration for anniversaries
- Multi-language support
- Custom animation themes

---

## Support & Resources

For help with v1.2:

- **Installation Issues:** See [NON_TECHNICAL_GUIDES/INSTALLATION_GUIDE.md](../NON_TECHNICAL_GUIDES/INSTALLATION_GUIDE.md)
- **Troubleshooting:** See [NON_TECHNICAL_GUIDES/TROUBLESHOOTING.md](../NON_TECHNICAL_GUIDES/TROUBLESHOOTING.md)
- **Configuration:** See [NON_TECHNICAL_GUIDES/CONFIGURATION_GUIDE.md](../NON_TECHNICAL_GUIDES/CONFIGURATION_GUIDE.md)
- **Technical Details:** See [TECHNICAL_REFERENCE.md](TECHNICAL_REFERENCE.md)
- **Architecture:** See [ARCHITECTURE.md](ARCHITECTURE.md)
- **Bug Details:** See [BUG_FIXES_v1.2.md](BUG_FIXES_v1.2.md)

---

## Summary

v1.2 represents a significant stability improvement over v1.1, with 19 bugs fixed and comprehensive validation enhancements. No breaking changes or new featuresï¿½pure quality and reliability improvements.

**Recommendation:** All v1.1 users should upgrade to v1.2 for improved stability and bug fixes. v1.2 is production-ready and recommended for all deployments.

---

**Release Date:** January 22, 2026  
**Next Update:** v1.2.2 (January 22, 2026) - Cleanup and documentation polish
